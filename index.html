<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comunidad ARC</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header id="mainHeader">
        <div class="header-top">
            <div class="menu-container">
                <button class="menu-btn" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>
                <div id="menuDropdown" class="menu-dropdown">
                    <a id="menuLogin" href="#" onclick="openModal('loginModal')">Iniciar Sesión</a>
                    <a id="menuLogout" href="#" onclick="logoutSystem()" style="display: none; color: #ff4d4d;">Cerrar Sesión</a>
                    <a href="#" onclick="openModal('updatesModal')">Actualizaciones</a>
                    <a href="#" onclick="openModal('contactModal')">Contactos</a>
                    
                    <a href="#" onclick="openAdminPanel()" id="btnAdminPanel" style="display: none; color: #ff4d4d; border-top: 1px solid #444;">
                        <i class="fas fa-shield-alt"></i> Panel Admin
                    </a>
                </div>
            </div>
            <h1 onclick="changeSection('Home')">COMUNIDAD ARC</h1>
            <div style="width: 40px;"></div>
        </div>
    </header>

    <div id="searchContainer">
        <div class="search-box-wrapper">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="searchInput" placeholder="Buscar usuarios o posts...">
        </div>
    </div>

    <main class="thread-container">
        </main>

    <button id="floatingAddBtn" class="floating-add-btn" onclick="openNewThreadPage()">
        <i class="fas fa-plus"></i>
    </button>

    <nav class="bottom-nav" id="mainBottomNav">
        <div class="nav-item active" id="nav-home" onclick="changeSection('Home')">
            <i class="fas fa-home"></i>
        </div>
        <div class="nav-item" id="nav-search" onclick="changeSection('Busqueda')">
            <i class="fas fa-search"></i>
        </div>
        <div class="nav-item-spacer"></div>
        
        <div class="nav-item" id="nav-activity" onclick="changeSection('Activity')">
            <i class="fas fa-heart"></i>
        </div>
        <div class="nav-item" id="nav-profile" onclick="openMyProfile()">
            <i class="fas fa-user"></i>
        </div>
    </nav>

    <div id="newThreadPage" class="full-screen-page">
        <div class="page-header-top">
            <button onclick="closeNewThreadPage()" class="back-btn-page"><i class="fas fa-times"></i></button>
            <h3>Nueva Publicación</h3>
            <button id="submitBtnHeader" onclick="submitNewThread()" style="background:none; border:none; color:#0095f6; font-weight:700; font-size:1rem;">Publicar</button>
        </div>
        
        <div style="padding: 20px;">
            <form id="newThreadForm">
                <input type="text" id="title" placeholder="Título..." required maxlength="50" style="background:transparent; border:none; border-bottom:1px solid #333; border-radius:0; font-size:1.2em; padding:10px 0;">
                
                <div class="custom-dropdown-container">
                    <input type="hidden" id="categorySelect" value="Creator">
                    
                    <div class="dropdown-trigger" onclick="toggleCustomDropdown('catOptions')">
                        <span id="catDisplay">Creator</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>

                    <div id="catOptions" class="dropdown-options">
                        <div class="dropdown-option" onclick="selectCustomOption('categorySelect', 'catDisplay', 'Creator', 'catOptions')">Creator</div>
                        <div class="dropdown-option" onclick="selectCustomOption('categorySelect', 'catDisplay', 'Elite', 'catOptions')">Elite</div>
                        <div class="dropdown-option" onclick="selectCustomOption('categorySelect', 'catDisplay', 'Mentor', 'catOptions')">Mentor</div>
                        <div class="dropdown-option" onclick="selectCustomOption('categorySelect', 'catDisplay', 'Designer', 'catOptions')">Designer</div>
                        <div class="dropdown-option" onclick="selectCustomOption('categorySelect', 'catDisplay', 'Top Model', 'catOptions')">Top Model</div>
                        <div class="dropdown-option" onclick="selectCustomOption('categorySelect', 'catDisplay', 'Cheerleader', 'catOptions')">Cheerleader</div>
                        <div class="dropdown-option" onclick="selectCustomOption('categorySelect', 'catDisplay', 'Hunter', 'catOptions')">Hunter</div>
                        <div class="dropdown-option" onclick="selectCustomOption('categorySelect', 'catDisplay', 'Moon & Sun', 'catOptions')">Moon & Sun</div>
                    </div>
                </div>

                <textarea id="description" placeholder="¿Qué estás pensando?" required style="background:transparent; border:none; border-bottom:1px solid #333; border-radius:0; min-height:150px; font-size:1em; margin-top:15px;"></textarea>
                
                <label for="imageFile" class="upload-btn-gray" style="margin-top:20px;">
                    <i class="fas fa-images"></i> Agregar imágenes
                </label>
                <input type="file" id="imageFile" accept="image/*" multiple style="display:none;">
                <span id="fileName" style="font-size:0.9em; color:#00a2ff; display:block; margin-top:5px;"></span>
            </form>
        </div>
    </div>

    <div id="loginModal" class="modal-overlay">
        <div class="modal-content small-modal">
            <span class="close-modal" onclick="closeModal('loginModal')">&times;</span>
            <h2>Iniciar Sesión</h2>
            <input type="text" id="loginUser" placeholder="Usuario">
            <input type="password" id="loginPin" placeholder="PIN (4 dígitos)" maxlength="4">
            <button onclick="loginSystem()">ENTRAR</button>
            <p class="switch-auth" onclick="openModal('registerModal')">¿No tienes cuenta? Regístrate</p>
        </div>
    </div>

    <div id="registerModal" class="modal-overlay">
        <div class="modal-content small-modal">
            <span class="close-modal" onclick="closeModal('registerModal')">&times;</span>
            <h2>Crear Cuenta</h2>
            <input type="text" id="regUser" placeholder="Nombre de usuario">
            <input type="password" id="regPin" placeholder="Crea un PIN (4 dígitos)" maxlength="4">
            <button onclick="registerSystem()">REGISTRARSE</button>
            <p class="switch-auth" onclick="openModal('loginModal')">¿Ya tienes cuenta? Entra aquí</p>
        </div>
    </div>

    <div id="commentsModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('commentsModal')">&times;</span>
            <h3>Comentarios</h3>
            <div id="commentsList" style="max-height: 300px; overflow-y: auto; text-align: left; margin-bottom: 15px;"></div>
            <form id="commentForm" style="display:flex; gap:5px;">
                <input type="text" id="commentInput" placeholder="Escribe un comentario..." required style="flex:1;">
                <button type="submit" style="width:auto; padding:0 15px;"><i class="fas fa-paper-plane"></i></button>
            </form>
        </div>
    </div>

    <div id="editProfileModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('editProfileModal')">&times;</span>
            <h3>Editar Perfil</h3>
            <div style="text-align:center; margin-bottom:15px;">
                <img id="editAvatarPreview" src="" style="width:100px; height:100px; border-radius:50%; object-fit:cover; border:4px solid #1c1c1c; box-shadow:0 0 0 2px #444;">
                <label for="avatarUpload" style="display:block; color:#00a2ff; cursor:pointer; font-size:0.9em; margin-top:10px;">Cambiar foto</label>
            </div>
            <input type="text" id="editNameInput" placeholder="Nombre visible">
            <input type="text" id="editHandleInput" placeholder="Usuario (@handle)">
            <input type="text" id="editStatusInput" placeholder="Estado / Rol corto (ej. Creador)">
            <textarea id="editBioInput" placeholder="Biografía..."></textarea>
            <button id="saveProfileBtn" onclick="saveProfileChanges()">GUARDAR CAMBIOS</button>
        </div>
    </div>

    <div id="userListPage" class="full-screen-page">
        <div class="page-header-top">
            <button onclick="closeUserListPage()" class="back-btn-page"><i class="fas fa-arrow-left"></i></button>
            <h3 id="listPageTitle">Usuario</h3>
            <div style="width: 30px;"></div>
        </div>
        <div class="page-tabs">
            <div class="page-tab" id="tab-following" onclick="switchListTab('following')">
                Siguiendo <span id="count-following" style="font-weight:700;">0</span>
            </div>
            <div class="page-tab" id="tab-followers" onclick="switchListTab('followers')">
                Seguidores <span id="count-followers" style="font-weight:700;">0</span>
            </div>
        </div>
        <div style="padding: 10px 15px; border-bottom: 1px solid #262626;">
            <div class="search-box-wrapper" style="background:#262626; border-radius:12px;">
                <i class="fas fa-search search-icon" style="top:50%; font-size:0.9em;"></i>
                <input type="text" id="userListSearch" placeholder="Buscar..." style="margin:0; background:transparent; border:none; padding:10px 10px 10px 40px; font-size:0.95em; color:white; width:100%;">
            </div>
        </div>
        <div id="userListContainer" class="page-list-container"></div>
    </div>

    <div id="accountInfoPage" class="full-screen-page" style="background:#000;">
        <div class="page-header-top">
            <button onclick="document.getElementById('accountInfoPage').style.display='none'" class="back-btn-page"><i class="fas fa-arrow-left"></i></button>
            <h3>Información</h3>
            <div style="width: 30px;"></div>
        </div>
        <div style="padding: 20px; text-align: center;">
            <img id="infoAvatar" src="" style="width: 100px; height: 100px; border-radius: 50%; border: 2px solid #333; margin-bottom: 15px;">
            <h2 id="infoUsername" style="margin: 0 0 20px 0; font-size: 1.3rem;"></h2>
            <p style="color: #888; font-size: 0.95em; margin-bottom: 30px; line-height: 1.5; padding: 0 10px;">
                En Comunidad ARC valoramos la autenticidad. Estos datos ayudan a verificar la identidad de nuestros miembros.
            </p>
            <div class="info-row" style="background: #111; padding: 20px; border-radius: 12px; margin-bottom: 10px; border:none;">
                <i class="far fa-calendar-alt" style="color: #666;"></i>
                <div class="info-text">
                    <span style="font-size: 0.9em; color: #888;">Fecha de unión</span>
                    <label id="infoDate" style="color: #fff; font-size: 1.1em; margin-top: 5px; font-weight: 600;"></label>
                </div>
            </div>
            <div class="info-row" style="background: #111; padding: 20px; border-radius: 12px; border:none;">
                <i class="fas fa-map-marker-alt" style="color: #666;"></i>
                <div class="info-text">
                    <span style="font-size: 0.9em; color: #888;">Ubicación principal</span>
                    <label id="infoLocation" style="color: #fff; font-size: 1.1em; margin-top: 5px; font-weight: 600;">Desconocida</label>
                </div>
            </div>
        </div>
    </div>

    <div id="profileOptionsModal" class="modal-overlay" style="z-index: 6000;">
        <div class="bottom-sheet-content">
            <div class="bottom-sheet-handle"></div>
            <div class="sheet-item danger" onclick="confirmBlockUser()">Bloquear</div>
            <div class="sheet-item danger" onclick="confirmReportUser()">Denunciar</div>
            <div class="sheet-divider"></div>
            <div class="sheet-item" onclick="showAccountInfo()">Información sobre esta cuenta</div>
            <div class="sheet-item" onclick="copyProfileUrl()">Copiar URL del perfil</div>
            <div class="sheet-item" onclick="closeModal('profileOptionsModal')">Cancelar</div>
        </div>
    </div>

    <div id="reportModal" class="modal-overlay" style="z-index: 7000;">
        <div class="info-content" style="max-width: 400px; padding: 20px; text-align: center;">
            <h3>Reportar</h3>
            <p id="reportTargetName" style="color:#00a2ff; font-weight:bold; margin-bottom:15px;"></p>
            <label style="display:block; margin:10px 0; text-align:left; color:#ccc;">Selecciona el motivo:</label>
            
            <div class="custom-dropdown-container" style="margin-top: 5px; margin-bottom: 20px;">
                <input type="hidden" id="reportReasonSelect" value="Spam">
                
                <div class="dropdown-trigger" onclick="toggleCustomDropdown('repOptions')">
                    <span id="repDisplay">Spam o Publicidad</span>
                    <i class="fas fa-chevron-down"></i>
                </div>

                <div id="repOptions" class="dropdown-options">
                    <div class="dropdown-option" onclick="selectCustomOption('reportReasonSelect', 'repDisplay', 'Spam', 'repOptions')">Spam o Publicidad</div>
                    <div class="dropdown-option" onclick="selectCustomOption('reportReasonSelect', 'repDisplay', 'Acoso', 'repOptions')">Acoso o Insultos</div>
                    <div class="dropdown-option" onclick="selectCustomOption('reportReasonSelect', 'repDisplay', 'Inapropiado', 'repOptions')">Contenido Inapropiado (+18)</div>
                    <div class="dropdown-option" onclick="selectCustomOption('reportReasonSelect', 'repDisplay', 'Odio', 'repOptions')">Discurso de Odio</div>
                    <div class="dropdown-option" onclick="selectCustomOption('reportReasonSelect', 'repDisplay', 'Suplantacion', 'repOptions')">Suplantación de Identidad</div>
                    <div class="dropdown-option" onclick="selectCustomOption('reportReasonSelect', 'repDisplay', 'Estafa', 'repOptions')">Estafa / Scam</div>
                    <div class="dropdown-option" onclick="selectCustomOption('reportReasonSelect', 'repDisplay', 'Otro', 'repOptions')">Otro motivo</div>
                </div>
            </div>

            <div class="modal-actions">
                <button onclick="document.getElementById('reportModal').style.display='none'" class="btn-modal btn-modal-cancel">Cancelar</button>
                <button onclick="submitReportAction()" class="btn-modal btn-modal-submit">ENVIAR</button>
            </div>
        </div>
    </div>

    <div id="updatesModal" class="modal-overlay"><div class="info-content"><span class="close-modal" onclick="closeModal('updatesModal')">&times;</span><h3>Actualizaciones</h3><p>Versión 5.2: Botones y Listas Premium.</p></div></div>
    <div id="contactModal" class="modal-overlay"><div class="info-content"><span class="close-modal" onclick="closeModal('contactModal')">&times;</span><h3>Contacto</h3><p>Instagram: arc_clxn</p></div></div>
    
    <div id="confirmModal" class="modal-overlay" style="z-index: 8000;">
        <div class="info-content" style="max-width: 300px; padding: 20px;">
            <h3>Confirmación</h3>
            <p id="confirmText">¿Estás seguro?</p>
            <div style="display:flex; justify-content:center; gap:10px;">
                <button onclick="closeModal('confirmModal')" style="background:#333; color:white; border:none; padding:8px 20px; border-radius:4px;">No</button>
                <button id="confirmActionBtn" style="background:#ff4d4d; color:white; border:none; padding:8px 20px; border-radius:4px;">Sí</button>
            </div>
        </div>
    </div>

    <div id="adminModal" class="modal-overlay"><div class="modal-content" style="max-height: 80vh; overflow-y: auto;"><span class="close-modal" onclick="closeModal('adminModal')">&times;</span><h3 style="color: #ff4d4d; border-bottom: 1px solid #444; padding-bottom: 10px;"><i class="fas fa-user-shield"></i> Panel de Moderación</h3><div id="adminReportsList"><p style="text-align:center; color:#777;">Cargando reportes...</p></div></div></div>

    <div id="toastContainer" class="toast-container"></div>
    <input type="file" id="avatarUpload" accept="image/*" style="display:none;">
    
    <script type="module" src="script.js"></script>

    <script>
        function toggleMenu() { document.getElementById("menuDropdown").classList.toggle("show"); }
        window.closeModal = (id) => document.getElementById(id).style.display = 'none';
        window.openModal = (id) => { 
            document.getElementById("menuDropdown").classList.remove('show');
            document.getElementById(id).style.display = 'block'; 
        }
        document.getElementById('imageFile').onchange = function() {
            if(this.files && this.files.length > 0) {
                if(this.files.length > 1) { document.getElementById('fileName').textContent = `${this.files.length} imágenes seleccionadas`; } 
                else { document.getElementById('fileName').textContent = this.files[0].name; }
            }
        };
        
        // --- LÓGICA DE DROPDOWNS PERSONALIZADOS ---
        window.toggleCustomDropdown = function(id) {
            document.querySelectorAll('.dropdown-options').forEach(el => {
                if(el.id !== id) el.classList.remove('show');
            });
            document.getElementById(id).classList.toggle('show');
        };

        window.selectCustomOption = function(inputId, displayId, value, menuId) {
            document.getElementById(inputId).value = value;
            document.getElementById(displayId).innerText = value;
            document.getElementById(menuId).classList.remove('show');
        };

        window.onclick = function(event) {
            const ids = ['reportModal', 'adminModal', 'profileOptionsModal', 'accountInfoModal'];
            ids.forEach(id => { if (event.target == document.getElementById(id)) document.getElementById(id).style.display = "none"; });
            
            // Cerrar dropdowns si se toca fuera
            if (!event.target.closest('.custom-dropdown-container')) {
                document.querySelectorAll('.dropdown-options.show').forEach(el => el.classList.remove('show'));
            }
        }
    </script>
</body>
</html>